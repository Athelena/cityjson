{
  "type": "CityJSON_Extension",
  "name": "Energy",
  "uri": "https://someurl.org/energy.json",
  "version": "0.1",
  "description": "CityJSON encoding for CityGML Energy ADE v1.0",
  "definitions": {
    "floorArea": {
      "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "type": { "enum": ["netFloorArea", "grossFloorArea", "energyReferenceArea"] },
            "value": { "type": "number" },
            "uom": { "type": "string" }  
          },
          "required": [ "type", "value", "uom" ],
          "additionalProperties": "false"
        }
    },
    "volumeType": {
      "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "type": { "enum": ["netVolume", "grossVolume", "energyReferenceVolume"] },
            "value": { "type": "number" },
            "uom": { "type": "string" }  
          },
          "required": [ "type", "value", "uom" ],
          "additionalProperties": "false"
        }
    },
    "refurbishmentMeasure": {
      "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "date": { "type":"string", "format":"date-time" },
            "level": { "enum": ["Advanced", "No refurbishment", "Standard"] },
            "description": { "type": "string" }
          },
          "required": [ "date", "level" ],
          "additionalProperties": "false"
        }
      }, 
    "transmittance":{
        "type": "object",
        "properties": {
          "fraction": {
            "type": "object",
              "properties": {
                 "value": { "type": "number" },
                 "uom": { "type": "string" } 
              }
           },
           "wavelengthRange": { "enum": [ "solar", "infrared", "visible", "total" ] }
        },
        "required": ["fraction", "wavelengthRange"],
        "additionalProperties": false
    },
    "shading": {
      "type": "object",
      "properties": {
        "maximumCoverRatio": {
          "type": "object",
          "properties": {
            "value": { "type": "number" },
            "uom": { "type": "string" } 
          },
          "additionalProperties": false
        },
        "transmittance": { "$ref": "#/definitions/transmittance" }
      },
      "additionalProperties": false
    },
    "heatExchange": {
      "type": "object",
      "properties": {
        "convectiveFraction": {
          "type": "object",
          "properties": {
            "value": { "type": "number" },
            "uom": { "type": "string" } 
          },
          "additionalProperties": false
        },
        "latentFraction": {
          "type": "object",
          "properties": {
            "value": { "type": "number" },
            "uom": { "type": "string" } 
          },
          "additionalProperties": false
        },
        "radiantFraction": {
          "type": "object",
          "properties": {
            "value": { "type": "number" },
            "uom": { "type": "string" } 
          },
          "additionalProperties": false
        },
        "totalValue": {
          "type": "object",
          "properties": {
            "value": { "type": "number" },
            "uom": { "type": "string" } 
          },
          "additionalProperties": false
        }
      },
      "required": [ "totalValue" ],
      "additionalProperties": false
    },
    "point": {
      "type": "object",
        "properties": {
          "type": { "enum": ["Point"] },
          "location": { "type": "integer" }
        },
        "required": [ "type", "location" ],
        "additionalProperties": false
      }
  },

  "extraRootProperties": {
      
  },
  
  "extraAttributes": {
    "Building": {
      "+buildingType": { "enum": ["Apartment Block", "Multi Family House", "Single Family House", "Terraced House"] },
      "+constructionWeight": { "enum": ["veryLight", "light", "medium", "heavy"] },
      "+energyPerformanceCertification": {
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "rating" : { "type": "string" },
            "name" : { "type": "string" },
            "certificationId" : { "type": "string" }
          },
          "required": [ "rating", "name" ],
          "additionalProperties": false
        }
      },
      "+volume": {
        "$ref":"#/definitions/volumeType"
      },
      "+isLandmarked": { "type": "boolean" },
      "+referencePoint": { "$ref":"#/definitions/point"},
      "+refurbishmentMeasure": {  "$ref":"#/definitions/refurbishmentMeasure" },
      "+floorArea": {
        "$ref":"#/definitions/floorArea"
      },
      "+heightAboveGround": {
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "heightReference": {
              "enum": [
                  "bottomOfConstruction",
                  "entrancePoint",
                  "generalEave",
                  "generalRoof",
                  "generalRoofEdge",
                  "highestEave",
                  "highestPoint",
                  "highestRoofEdge",
                  "lowestEave",
                  "lowestFloorAboveGround",
                  "lowestRoofEdge",
                  "topOfConstruction",
                  "topThermalBoundary",
                  "bottomThermalBoundary"
                ] 
            },
            "value": {"type": "number"},
            "uom": {"type": "string"}
          },
          "required": [ "heightReference", "value", "uom" ],
          "additionalProperties": "false"
        }
      },
      "+usageZone": {
        "type": "array",
        "items": {
          "type": "string" 
        }
      },
      "+thermalZone": {
        "type": "array",
        "items": {
          "type": "string"
        }
      },
      "+aggregatedBuildingConstruction": {
        "type": "array",
        "items": {
          "type": "string"
        },
        "minItems":0,
        "maxItems":1
      }
    }
  },
  
  "extraCityObjects": {
		"+ThermalZone": {
			"allOf": [
					{ "$ref": "../cityobjects.schema.json#/_AbstractCityObject" },
        	{
            "properties": {
              "type": { "enum": ["+ThermalZone"] },
              "attributes": {
              	"type": "object",
              	"properties": {
                "additionalThermalBridgeUValue": {
                	"type": "object",
                	"properties": {
                  	"value": { "type": "number" },
                    "uom": { "type": "string" } 
               	  }
              	},
              	"effectiveThermalCapacity": {
                	"type": "object",
                	"properties": {
                  	"value": { "type": "number" },
                  	"uom": { "type": "string" } 
                 	}
               	},
              	"floorArea": { "$ref":"#/definitions/floorArea" },
              	"volume": { "$ref":"#/definitions/volumeType" },
              	"indirectlyHeatedAreaRatio": {
                	"type": "object",
                	"properties": {
                  	"value": { "type": "number" },
                  	"uom": { "type": "string" } 
                	},
                	"additionalProperties": false
              	},
              	"infiltrationRate": {
                	"type": "object",
                	"properties": {
                  	"value": { "type": "number" },
                  	"uom": { "type": "string" } 
                	},
                	"additionalProperties": false
              	},
              	"isCooled": { "type": "boolean"},
              	"isHeated": { "type": "boolean"},
              	"containedUsageZone": {
                	"type": "array",
                 	"items": {
                 		"type": "string" 
               		}
             		},
                "containedThermalBoundary": {
               		"type": "array",
               		"items": {
                	 "type": "string" 
               		}
             		},
              	"interiorRoom": {
               		"type": "array",
               		"items": {
                 		"type": "string" 
               		}
             		}            
              	},
              	"additionalProperties": false
              },
              "geometry": {
                "type": "array",
                	"items": {
                  	"type": "object",
                  	"oneOf": [
                  		{"$ref": "../geomprimitives.schema.json#/Solid"},
                  		{"$ref": "../geomprimitives.schema.json#/MultiSolid"},
                  		{"$ref": "../geomprimitives.schema.json#/CompositeSolid"}
                  	]
                	},
                	"minItems":0,
                	"maxItems":1
             		}
              	
            },
            "required": ["type"],
            "additionalProperties": false
          }
      ]
    },
    "+ThermalBoundary": {
    	"allOf": [
      	{ "$ref": "../cityobjects.schema.json#/_AbstractCityObject" },
        {
        	"properties": {
        		"type": { "enum": ["+ThermalBoundary"] },
        		"attributes": {
        			"type": "object",
        			"properties":{
              "thermalBoundaryType": { "enum": [ "interiorWall", "intermediaryFloor", "sharedWall", "outerWall", "groundSlab", "basementCeiling", "atticFloor", "roof" ] },
              "azimuth": {
                "type": "object",
                "properties": {
                  "value": { "type": "number" },
                  "uom": { "type": "string" } 
                },
                "additionalProperties": false
              },
              "inclination": {
                "type": "object",
                "properties": {
                  "value": { "type": "number" },
                  "uom": { "type": "string" } 
                },
                "additionalProperties": false
              },
              "area": {
                "type": "object",
                "properties": {
                  "value": { "type": "number" },
                  "uom": { "type": "string" } 
                },
                "additionalProperties": false
              },
              "refurbishmentMeasure": { "$ref":"#/definitions/refurbishmentMeasure" },
              "containedThermalOpening": {
                "type": "array",
                "items": {
                  "type": "string"
                }
              },
              "construction": {
                "type": "array",
                "items": {
                  "type": "string"
                },
                "minItems":0,
                "maxItems":1
              }             
        			},
        			"required": ["thermalBoundaryType"],
        			"additionalProperties": false
        		},
        		"geometry": {
              "type": "array",
                "items": {
                  "type": "object",
                  "$ref": "../geomprimitives.schema.json#/MultiSurface" 
                },
                "minItems":0,
                "maxItems":1
              }
              
          },
          "required": ["type"],
          "additionalProperties": false
        }
      ]
    },
    "+UsageZone": {
    	"allOf": [
      	{ "$ref": "../cityobjects.schema.json#/_AbstractCityObject" },
        {
        	"properties": {
        		"type": { "enum": ["+UsageZone"] },
          	"attributes": {  
          		"type": "object",
          		"properties": {
              "usageZoneType": { "type": "string"},
              "coolingSchedule": { "type": "string" },
              "heatingSchedule": { "type": "string" },
              "ventilationSchedule": { "type": "string" },
              "usedFloors": {
                "type": "array",
                "items": {
                  "type": "integer"
                }
              },
              "floorArea": {
                "$ref": "#/definitions/floorArea"
              },
              "averageInternalGains": { "$ref":"#/definitions/heatExchange" },
              "containedBuidingUnits": {
                "type": "array",
                "items": {
                  "type": "string"
                }
              },
              "eqquipedWithFacilities": {
                "type": "array",
                "items": {
                  "type": "string"
                }
              },
              "occupants": {
                "type": "array",
                "items": {
                  "type": "string"
                }
              }             
          		},
          		"required": ["usageZoneType"],
          		"additionalProperties": false
          	},
          	"geometry": {
              "type": "array",
                "items": {
                  "type": "object",
                  "oneOf": [
                  {"$ref": "../geomprimitives.schema.json#/Solid"},
                  {"$ref": "../geomprimitives.schema.json#/MultiSolid"},
                  {"$ref": "../geomprimitives.schema.json#/CompositeSolid"}
                  ]
                },
                "minItems":0,
                "maxItems":1
             }              
          },
           "required": ["type"],
           "additionalProperties": false
          }
        ]
      },
    "+ThermalOpening": {
       "allOf": [
          { "$ref": "../cityobjects.schema.json#/_AbstractCityObject" },
          {
          	"properties": {
          		"type": { "enum": ["+ThermalOpening"] },
              "attributes": {     
              	"type": "object",
              	"properties":{
              	"area": {
                	"type": "object",
                	"properties": {
                  	"value": { "type": "number" },
                  	"uom": { "type": "string" } 
                	},
                	"additionalProperties": false
             	  },
              	"indoorShading": { "$ref":"#/definitions/shading" },
              	"outdoorShading": { "$ref":"#/definitions/shading" },
              	"openableRatio": {
                	"type": "object",
                	"properties": {
                	  "value": { "type": "number" },
                  	"uom": { "type": "string" } 
                	},
                	"additionalProperties": false
              	},
              	"construction": {
               		"type": "array",
                	"items": {
                  	"type": "string"
                	},
                	"minItems":0,
                	"maxItems":1
              	}                       
              	},
              	"additionalProperties": false
              },
              "geometry": { 
                "type": "array",
                	"items": {
                  	"type": "object",
                  	"$ref": "../geomprimitives.schema.json#/MultiSurface" 
                	}
              	}              	
            },
           	"required": ["type"],
           	"additionalProperties": false
         	}
       	]
    	}
  }
}