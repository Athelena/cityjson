{
  "$schema": "http://json-schema.org/draft-04/schema#",
  "title": "CityJSON City Objects schema v0.9",


  "ExtensionObject": {
    "type": "object",
    "properties": {
      "type": {
        "type": "string",
        "pattern": "(\\+)([A-Z])\\w+"
      }
    },
    "required": ["type"]
  },

  "_AbstractCityObject": {
    "properties": {
      "attributes": {
        "type": "object",
        "properties": {
          "creationDate" : {"type": "string", "format": "date"},
          "terminationDate" : {"type": "string", "format": "date"},
          "class": {"type": "string"},
          "function": {"type": "string"},
          "usage": {"type": "string"}
        }
      },
      "geographicalExtent": {
        "type": "array",
        "items": { "type": "number" },
        "minItems": 6,    
        "maxItems": 6    
      }
    }
  },


  "_AbstractBuilding": {
    "properties": {
      "attributes": {
        "properties": {
          "measuredHeight": { "type": "number"},
          "roofType": { "type": "string"},
          "storeysAboveGround": { "type": "integer"},
          "storeysBelowGround": { "type": "integer"},
          "storeyHeightsAboveGround": { 
            "type": "array",
            "items": {"type": "number"}
          },
          "storeyHeightsBelowGround": { 
            "type": "array",
            "items": {"type": "number"}
          },
          "yearOfConstruction": { "type": "integer"},
          "yearOfDemolition": { "type": "integer"}
        }
      },
      "address": {
        "type": "object",
        "properties": {
          "CountryName": {"type": "string"},
          "LocalityName": {"type": "string"},
          "ThoroughfareNumber": {"type": "string"},
          "ThoroughfareName": {"type": "string"},
          "PostalCode": {"type": "string"},
          "location": {"$ref": "geomprimitives.json#/MultiPoint"}
        }
      },
      "children": {
        "type": "array",
        "description": "the IDs of the BuildingPart/Installation of this Building",
        "items": {"type": "string"}
      },
      "geometry": {
        "type": "array",
        "items": {
          "oneOf": [
            {"$ref": "geomprimitives.json#/MultiSurface"},
            {"$ref": "geomprimitives.json#/Solid"},
            {"$ref": "geomprimitives.json#/CompositeSolid"}
          ] 
        }
      }
    },
    "required": ["geometry"]
  },
  

  "Building": {
    "allOf": [
      { "$ref": "#/_AbstractCityObject"},
      { "$ref": "#/_AbstractBuilding" },
      {
        "properties": {
          "type": { "enum": ["Building"] }
        },
        "required": ["type"]
      }
    ]
  },

  "BuildingPart": {
    "allOf": [
      { "$ref": "#/_AbstractCityObject"},
      { "$ref": "#/_AbstractBuilding" },
      {
        "properties": {
          "type": { "enum": ["BuildingPart"] },
          "parent": {
            "type": "string",
            "description": "the ID of the parent Building"
          }
        },
        "required": ["type", "parent"]
      }
    ]
  },


  "BuildingInstallation": {
    "allOf": [
      { "$ref": "#/_AbstractCityObject"},
      {
        "properties": {
          "type": { "enum": ["BuildingInstallation"] },
          "parent": {
            "type": "string",
            "description": "the ID of the parent Building"
          },
          "geometry": {
            "type": "array",
            "items": {
              "oneOf": [
                {"$ref": "geomprimitives.json#/MultiPoint"},
                {"$ref": "geomprimitives.json#/MultiLineString"},
                {"$ref": "geomprimitives.json#/Solid"},
                {"$ref": "geomprimitives.json#/MultiSolid"},
                {"$ref": "geomprimitives.json#/CompositeSolid"},
                {"$ref": "geomprimitives.json#/MultiSurface"},
                {"$ref": "geomprimitives.json#/CompositeSurface"},            
                {"$ref": "geomtemplates.json#/GeometryInstance"}
              ] 
            }
          }
        },
        "required": ["type", "geometry" , "parent"]
      }
    ]
  },


  "CityObjectGroup": {
    "allOf": [
      { "$ref": "#/_AbstractCityObject"},
      {
        "properties": {
          "type": { "enum": ["CityObjectGroup"] },
          "members": {
            "type": "array",
            "description": "the IDs of the CityObjects members of that group",
            "items": {"type": "string"}
          },
          "geometry": {
            "type": "array",
            "items": {
              "oneOf": [
                {"$ref": "geomprimitives.json#/MultiPoint"},
                {"$ref": "geomprimitives.json#/MultiLineString"},
                {"$ref": "geomprimitives.json#/Solid"},
                {"$ref": "geomprimitives.json#/MultiSolid"},
                {"$ref": "geomprimitives.json#/CompositeSolid"},
                {"$ref": "geomprimitives.json#/MultiSurface"},
                {"$ref": "geomprimitives.json#/CompositeSurface"}            
              ] 
            },
            "minItems": 0,    
            "maxItems": 1 
          }
        },
        "required": ["type", "members"]
      }
    ]
  },


  "_AbstractTunnel": {
    "properties": {
      "attributes": {
        "properties": {
          "yearOfConstruction": { "type": "integer"},
          "yearOfDemolition": { "type": "integer"}
        }
      },
      "children": {
        "type": "array",
        "description": "the IDs of the TunnelPart/Installation of this Tunnel",
        "items": {"type": "string"}
      },
      "geometry": {
        "type": "array",
        "items": {
          "oneOf": [
            {"$ref": "geomprimitives.json#/MultiSurface"},
            {"$ref": "geomprimitives.json#/Solid"},
            {"$ref": "geomprimitives.json#/CompositeSolid"}
          ] 
        }
      }
    },
    "required": ["geometry"]
  },
  

  "Tunnel": {
    "allOf": [
      { "$ref": "#/_AbstractCityObject"},
      { "$ref": "#/_AbstractTunnel" },
      {
        "properties": {
          "type": { "enum": ["Tunnel"] }
        },
        "required": ["type"]
      }
    ]
  },

  "TunnelPart": {
    "allOf": [
      { "$ref": "#/_AbstractCityObject"},
      { "$ref": "#/_AbstractTunnel" },
      {
        "properties": {
          "type": { "enum": ["TunnelPart"] },
          "parent": {
            "type": "string",
            "description": "the ID of the parent Tunnel"
          }
        },
        "required": ["type", "parent"]
      }
    ]
  },


  "TunnelInstallation": {
    "allOf": [
      { "$ref": "#/_AbstractCityObject"},
      {
        "properties": {
          "type": { "enum": ["TunnelInstallation"] },
          "parent": {
            "type": "string",
            "description": "the ID of the parent Tunnel"
          },
          "geometry": {
            "type": "array",
            "items": {
              "oneOf": [
                {"$ref": "geomprimitives.json#/MultiPoint"},
                {"$ref": "geomprimitives.json#/MultiLineString"},
                {"$ref": "geomprimitives.json#/Solid"},
                {"$ref": "geomprimitives.json#/MultiSolid"},
                {"$ref": "geomprimitives.json#/CompositeSolid"},
                {"$ref": "geomprimitives.json#/MultiSurface"},
                {"$ref": "geomprimitives.json#/CompositeSurface"},            
                {"$ref": "geomtemplates.json#/GeometryInstance"}
              ] 
            }
          }
        },
        "required": ["type", "geometry" , "parent"]
      }
    ]
  },


  "_AbstractBridge": {
    "properties": {
      "attributes": {
        "properties": {
          "yearOfConstruction": {"type": "integer"},
          "yearOfDemolition": {"type": "integer"},
          "isMovable": {"type": "boolean" }
        }
      },
      "children": {
        "type": "array",
        "description": "the IDs of the Bridge/Part/Installation/CE of this Bridge",
        "items": {"type": "string"}
      },
      "geometry": {
        "type": "array",
        "items": {
          "oneOf": [
            {"$ref": "geomprimitives.json#/MultiSurface"},
            {"$ref": "geomprimitives.json#/Solid"},
            {"$ref": "geomprimitives.json#/CompositeSolid"}
          ] 
        }
      }
    },
    "required": ["geometry"]
  },
  

  "Bridge": {
    "allOf": [
      { "$ref": "#/_AbstractCityObject"},
      { "$ref": "#/_AbstractBridge" },
      {
        "properties": {
          "type": { "enum": ["Bridge"] }
        },
        "required": ["type"]
      }
    ]
  }, 


  "BridgePart": {
    "allOf": [
      { "$ref": "#/_AbstractCityObject"},
      { "$ref": "#/_AbstractBridge" },
      {
        "properties": {
          "type": { "enum": ["BridgePart"] },
          "parent": {
            "type": "string",
            "description": "the ID of the parent Building"
          }
        },
        "required": ["type", "parent"]
      }
    ]
  },


  "BridgeInstallation": {
    "allOf": [
      { "$ref": "#/_AbstractCityObject"},
      {
        "properties": {
          "type": { "enum": ["BridgeInstallation"] },
          "parent": {
            "type": "string",
            "description": "the ID of the parent Bridge"
          },
          "geometry": {
            "type": "array",
            "items": {
              "oneOf": [
                {"$ref": "geomprimitives.json#/MultiPoint"},
                {"$ref": "geomprimitives.json#/MultiLineString"},
                {"$ref": "geomprimitives.json#/Solid"},
                {"$ref": "geomprimitives.json#/MultiSolid"},
                {"$ref": "geomprimitives.json#/CompositeSolid"},
                {"$ref": "geomprimitives.json#/MultiSurface"},
                {"$ref": "geomprimitives.json#/CompositeSurface"},            
                {"$ref": "geomtemplates.json#/GeometryInstance"}
              ] 
            }
          }
        },
        "required": ["type", "geometry" , "parent"]
      }
    ]
  },    


  "BridgeConstructionElement": {
    "allOf": [
      { "$ref": "#/_AbstractCityObject"},
      {
        "properties": {
          "type": { "enum": ["BridgeConstructionElement"] },
          "parent": {
            "type": "string",
            "description": "the ID of the parent Bridge"
          },
          "geometry": {
            "type": "array",
            "items": {
              "oneOf": [
                {"$ref": "geomprimitives.json#/MultiPoint"},
                {"$ref": "geomprimitives.json#/MultiLineString"},
                {"$ref": "geomprimitives.json#/Solid"},
                {"$ref": "geomprimitives.json#/MultiSolid"},
                {"$ref": "geomprimitives.json#/CompositeSolid"},
                {"$ref": "geomprimitives.json#/MultiSurface"},
                {"$ref": "geomprimitives.json#/CompositeSurface"},            
                {"$ref": "geomtemplates.json#/GeometryInstance"}
              ] 
            }
          }
        },
        "required": ["type", "geometry" , "parent"]
      }
    ]
  }, 


  "_AbstractTransportationComplex": {
    "properties": {
      "attributes": {
        "properties": {
          "surfaceMaterial": {
            "type": "array",
            "items": {"type": "string"}
          }
        }
      },
      "geometry": {
        "type": "array",
        "items": {
          "oneOf": [
            {"$ref": "geomprimitives.json#/MultiSurface"},
            {"$ref": "geomprimitives.json#/CompositeSurface"}
          ] 
        }
      }
    },
    "required": ["geometry"]
  },
  
  
  "Road": {
    "allOf": [
      { "$ref": "#/_AbstractCityObject"},
      { "$ref": "#/_AbstractTransportationComplex" },
      {
        "properties": {
          "type": { "enum": ["Road"] }
        },
        "required": ["type"]
      }
    ]
  },


  "Railway": {
    "allOf": [
      { "$ref": "#/_AbstractCityObject"},
      { "$ref": "#/_AbstractTransportationComplex" },
      {
        "properties": {
          "type": { "enum": ["Railway"] }
        },
        "required": ["type"]
      }
    ]
  },

  "TransportSquare": {
    "allOf": [
      { "$ref": "#/_AbstractCityObject"},
      { "$ref": "#/_AbstractTransportationComplex" },
      {
        "properties": {
          "type": { "enum": ["TransportSquare"] }       
        },
        "required": ["type"]
      }
    ]
  },  


  "TINRelief": {
    "allOf": [
      { "$ref": "#/_AbstractCityObject"},
      {
        "properties": {
          "type": { "enum": ["TINRelief"] },
          "geometry": {
            "type": "array",
            "items": {
              "oneOf": [
                {"$ref": "geomprimitives.json#/CompositeSurface"}
              ]
            }
          }        
        },
        "required": ["type", "geometry"]
      }
    ]
  },


  "WaterBody": {
    "allOf": [
      { "$ref": "#/_AbstractCityObject"},
      {
        "properties": {
          "type": { "enum": ["WaterBody"] },
          "geometry": {
            "type": "array",
            "items": {
              "oneOf": [
                {"$ref": "geomprimitives.json#/MultiLineString"},
                {"$ref": "geomprimitives.json#/MultiSurface"},
                {"$ref": "geomprimitives.json#/CompositeSurface"},
                {"$ref": "geomprimitives.json#/Solid"},
                {"$ref": "geomprimitives.json#/CompositeSolid"}
              ]
            }
          }        
        },
        "required": ["type", "geometry"]
      }
    ]
  },


  "PlantCover": {
    "allOf": [
      { "$ref": "#/_AbstractCityObject"},
      {
        "properties": {
          "type": { "enum": ["PlantCover"] },
          "attributes": {
            "properties": {
              "averageHeight": {"type": "number"}
            }
          },
          "geometry": {
            "type": "array",
            "items": {
              "oneOf": [
                {"$ref": "geomprimitives.json#/MultiSolid"},
                {"$ref": "geomprimitives.json#/MultiSurface"}
              ]
            }
          }        
        },
        "required": ["type", "geometry"]
      }
    ]
  },  


  "SolitaryVegetationObject": {
    "allOf": [
      { "$ref": "#/_AbstractCityObject"},
      {
        "properties": {
          "type": { "enum": ["SolitaryVegetationObject"] },
          "attributes": {
            "properties": {
              "species": {"type": "string"},
              "trunkDiameter": {"type": "number"},
              "crownDiameter": {"type": "number"}
            }
          },
          "geometry": {
            "type": "array",
            "items": {
              "oneOf": [
                {"$ref": "geomprimitives.json#/MultiPoint"},
                {"$ref": "geomprimitives.json#/MultiLineString"},
                {"$ref": "geomprimitives.json#/Solid"},
                {"$ref": "geomprimitives.json#/MultiSolid"},
                {"$ref": "geomprimitives.json#/CompositeSolid"},
                {"$ref": "geomprimitives.json#/MultiSurface"},
                {"$ref": "geomprimitives.json#/CompositeSurface"},
                {"$ref": "geomtemplates.json#/GeometryInstance"}
              ]
            }
          }        
        },
        "required": ["type", "geometry"]
      }
    ]
  },


  "LandUse": {
    "allOf": [
      { "$ref": "#/_AbstractCityObject"},
      {
        "properties": {
          "type": { "enum": ["LandUse"] },
          "geometry": {
            "type": "array",
            "items": {
              "oneOf": [
                {"$ref": "geomprimitives.json#/MultiSurface"},
                {"$ref": "geomprimitives.json#/CompositeSurface"}
              ]
            }
          }        
        },
        "required": ["type", "geometry"]
      }
    ]
  },


  "CityFurniture": {
    "allOf": [
      { "$ref": "#/_AbstractCityObject"},
      {
        "properties": {
          "type": { "enum": ["CityFurniture"] },
          "geometry": {
            "type": "array",
            "items": {
              "oneOf": [
                {"$ref": "geomprimitives.json#/MultiPoint"},
                {"$ref": "geomprimitives.json#/MultiLineString"},
                {"$ref": "geomprimitives.json#/Solid"},
                {"$ref": "geomprimitives.json#/MultiSolid"},
                {"$ref": "geomprimitives.json#/CompositeSolid"},
                {"$ref": "geomprimitives.json#/MultiSurface"},
                {"$ref": "geomprimitives.json#/CompositeSurface"},
                {"$ref": "geomtemplates.json#/GeometryInstance"}
              ]
            }
          }        
        },
        "required": ["type", "geometry"]
      }
    ]
  },


  "GenericCityObject": {
    "allOf": [
      { "$ref": "#/_AbstractCityObject"},
      {
        "properties": {
          "type": { "enum": ["GenericCityObject"] },
          "geometry": {
            "type": "array",
            "items": {
              "oneOf": [
                {"$ref": "geomprimitives.json#/MultiPoint"},
                {"$ref": "geomprimitives.json#/MultiLineString"},
                {"$ref": "geomprimitives.json#/Solid"},
                {"$ref": "geomprimitives.json#/MultiSolid"},
                {"$ref": "geomprimitives.json#/CompositeSolid"},
                {"$ref": "geomprimitives.json#/MultiSurface"},
                {"$ref": "geomprimitives.json#/CompositeSurface"},
                {"$ref": "geomtemplates.json#/GeometryInstance"}
              ]
            }
          }        
        },
        "required": ["type", "geometry"]
      }
    ]
  }


}